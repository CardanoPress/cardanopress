var G=Object.defineProperty;var Y=(w,h,p)=>h in w?G(w,h,{enumerable:!0,configurable:!0,writable:!0,value:p}):w[h]=p;var c=(w,h,p)=>Y(w,typeof h!="symbol"?h+"":h,p);let u,B,O,P,U,q,W,V,T,k,M,D,$,R,I,L,j,_,F,H,J=(async()=>{var A,C;let w,h,p,x,E;O={0:"testnet",1:"mainnet"},w={too_big:"Transaction too big",not_possible:"Transaction not possible (maybe insufficient balance)",invalid_hereafter:7200},_=Object.freeze(["Eternl","Yoroi","Typhon","GeroWallet","NuFi","Lace","Begin"]),h="modulepreload",p=function(t){return"/wp-content/plugins/cardanopress/assets/dist/"+t},x={},E=function(t,e,a){let o=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),n=(r==null?void 0:r.nonce)||(r==null?void 0:r.getAttribute("nonce"));o=Promise.all(e.map(s=>{if(s=p(s),s in x)return;x[s]=!0;const i=s.endsWith(".css"),d=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${d}`))return;const l=document.createElement("link");if(l.rel=i?"stylesheet":h,i||(l.as="script",l.crossOrigin=""),l.href=s,n&&l.setAttribute("nonce",n),document.head.appendChild(l),i)return new Promise((f,N)=>{l.addEventListener("load",f),l.addEventListener("error",()=>N(new Error(`Unable to preload CSS for ${s}`)))})}))}return o.then(()=>t()).catch(r=>{const n=new Event("vite:preloadError",{cancelable:!0});if(n.payload=r,window.dispatchEvent(n),!n.defaultPrevented)throw r})},u=(A=class{static async load(){return u.Module===void 0&&(u.Module=await E(()=>import("./cardano_serialization_lib-pHqu9iRB.js").then(async t=>(await t.__tla,t)),[])),u.Module}},c(A,"Module"),A);const y=class y{static async load(){return y.Module===void 0&&(y.Module=(await E(async()=>{const{Buffer:e}=await import("./index-BTZikr4I.js").then(a=>a.i);return{Buffer:e}},[])).Buffer),y.Module}};c(y,"Module");let m=y,b,v,S,g;I=t=>(parseFloat(t||"1")*1e6).toFixed(),b=async t=>{const e=await u.load(),a=await m.load();return e.Address.from_bytes(a.from(t,"hex")).to_bech32()},v=t=>{let e="";for(var a=0,o=t.length;a<o;a++)e+=t.charCodeAt(a).toString(16);return e},$=Object.freeze(Object.defineProperty({__proto__:null,adaToLovelace:I,hexEncode:v,hexToBech32:b},Symbol.toStringTag,{value:"Module"})),S=async(t,e)=>{const a=await u.load(),o=a.TransactionOutputs.new();return o.add(a.TransactionOutput.new(a.Address.from_bech32(e),a.Value.new(a.BigNum.from_str(t)))),o},g=async(t,e,a,o,r=null)=>{const n=await u.load(),s=n.TransactionBuilderConfigBuilder.new().fee_algo(n.LinearFee.new(n.BigNum.from_str(o.minFeeA.toString()),n.BigNum.from_str(o.minFeeB.toString()))).coins_per_utxo_byte(n.BigNum.from_str(o.coinsPerUtxoSize)).pool_deposit(n.BigNum.from_str(o.poolDeposit)).key_deposit(n.BigNum.from_str(o.keyDeposit)).max_value_size(o.maxValSize).max_tx_size(o.maxTxSize).prefer_pure_change(!0),i=n.TransactionBuilder.new(s.build());r&&i.set_certs(r);const d=n.TransactionUnspentOutputs.new();e.forEach(f=>d.add(f)),i.add_output(a.get(0)),i.set_ttl(o.slot+w.invalid_hereafter),i.add_inputs_from(d,n.CoinSelectionStrategyCIP2.RandomImproveMultiAsset),i.add_change_if_needed(n.Address.from_bech32(t));const l=n.Transaction.new(i.build(),n.TransactionWitnessSet.new());if(l.to_bytes().length*2>o.maxTxSize)throw w.too_big;return l},H=Object.freeze(Object.defineProperty({__proto__:null,buildTx:g,prepareTx:S},Symbol.toStringTag,{value:"Module"}));class K{constructor(e,a){c(this,"type");c(this,"cardano");c(this,"getNetwork",async()=>{let e=await this.cardano.getNetworkId();return this.type==="Typhon"&&(e=e.data),O[e]});c(this,"getBalance",async()=>{if(this.type==="Typhon")return(await this.cardano.getBalance()).data.ada;const e=await this.cardano.getBalance(),a=await u.load(),o=await m.load();return a.Value.from_bytes(o.from(e,"hex")).coin().to_str()});c(this,"getChangeAddress",async()=>{if(this.type==="Typhon")return(await this.cardano.getAddress()).data;const e=await this.cardano.getChangeAddress();return await b(e)});c(this,"getRewardAddress",async()=>{if(this.type==="Typhon")return(await this.cardano.getRewardAddress()).data;const e=await this.cardano.getRewardAddresses();return await b(e[0])});c(this,"getUtxos",async()=>{if(this.type==="Typhon")return[];const e=await this.cardano.getUtxos(),a=await u.load(),o=await m.load();return e.map(r=>a.TransactionUnspentOutput.from_bytes(o.from(r,"hex")))});c(this,"getStakeKeyHash",async()=>{var o,r,n;const e=await this.getRewardAddress(),a=await u.load();return(n=(r=(o=a.RewardAddress.from_address(a.Address.from_bech32(e)))==null?void 0:o.payment_cred())==null?void 0:r.to_keyhash())==null?void 0:n.to_bytes()});c(this,"signData",async e=>{const a=v(e);let o=this.cardano;return this.type==="Typhon"&&(o=await window.cardano.typhoncip30.enable()),o.signData(await o.getChangeAddress(),a)});c(this,"signAndSubmit",async e=>{if(this.type==="Typhon")throw"No implementation from the extension";try{const a=await m.load(),o=await u.load(),r=a.from(e.to_bytes()),n=await this.cardano.signTx(r.toString("hex")),s=o.Transaction.new(e.body(),o.TransactionWitnessSet.from_bytes(a.from(n,"hex")));let i=a.from(s.to_bytes());return await this.cardano.submitTx(i.toString("hex"))}catch(a){throw a.info}});c(this,"payTo",async(e,a,o=null)=>{if(this.type==="Typhon"){const{status:r,data:n,error:s,reason:i}=await this.cardano.paymentTransaction({outputs:[{address:e,amount:a}]});if(r)return n.transactionId;throw s??i}if(!o)throw"Required protocol parameters";try{const r=await this.getChangeAddress(),n=await this.getUtxos(),s=await S(a,e),i=await g(r,n,s,o);return await this.signAndSubmit(i)}catch(r){throw r}});c(this,"multiSend",async(e,a=null)=>{if(this.type==="Typhon"){const{status:o,data:r,error:n,reason:s}=await this.cardano.paymentTransaction({outputs:e});if(o)return r.transactionId;throw n??s}if(!a)throw"Required protocol parameters";try{const o=await this.getChangeAddress(),r=await this.getUtxos(),n=await u.load(),s=n.TransactionOutputs.new();e.forEach(d=>{s.add(n.TransactionOutput.new(n.Address.from_bech32(d.address),n.Value.new(n.BigNum.from_str(d.amount))))});const i=await g(o,r,s,a);return await this.signAndSubmit(i)}catch(o){throw o}});c(this,"delegateTo",async(e,a=null,o=null)=>{if(this.type==="Typhon"){const{status:r,data:n,error:s,reason:i}=await this.cardano.delegationTransaction({poolId:e});if(r)return n.transactionId;throw s??i}if(!a)throw"Required protocol parameters";if(!o)throw"Required account information";try{const r=await this.getChangeAddress(),n=await this.getUtxos(),s=await S(a.keyDeposit,r),i=await this.getStakeKeyHash(),d=await u.load(),l=await m.load(),f=d.Certificates.new();o.active||f.add(d.Certificate.new_stake_registration(d.StakeRegistration.new(d.Credential.from_keyhash(d.Ed25519KeyHash.from_bytes(l.from(i)))))),f.add(d.Certificate.new_stake_delegation(d.StakeDelegation.new(d.Credential.from_keyhash(d.Ed25519KeyHash.from_bytes(l.from(i))),d.Ed25519KeyHash.from_bytes(l.from(e,"hex")))));const N=await g(r,n,s,a,f);return await this.signAndSubmit(N)}catch(r){throw r}});this.type=e,this.cardano=a}}let z;z=async t=>{const e=await window.cardano[t].enable();if(t==="typhon"){if(e.status===!1)throw(e==null?void 0:e.error)??e.reason;return await window.cardano[t]}return e},T=t=>{var e,a;return((a=(e=window.cardano[t.toLowerCase()])==null?void 0:e.experimental)==null?void 0:a.vespr_compat)||!1},B=(C=class{static isSupported(t){return t==="VESPR"?!0:_.includes(t)}static fromVespr(){return _.filter(T)}static hasWallet(t){var e;return this.isSupported(t)?!!((e=window.cardano)!=null&&e[t.toLowerCase()]):!1}static async isEnabled(t){return this.hasWallet(t)?window.cardano[t.toLowerCase()].isEnabled():!1}static async getWallet(t){if(!this.isSupported(t))throw`Not supported wallet "${t}"`;if(!this.hasWallet(t))throw`Not available wallet "${t}"`;const e=t.toLowerCase(),a=`${e}Object`;if(this[a]===void 0||!await this.isEnabled(t))try{this[a]=new K(t,await z(e))}catch(o){throw typeof o=="string"?o:o.info||o.message||"user abort connection"}return Object.freeze(this[a])}},c(C,"supported",_),C),q=window.cardanoPress||{ajaxUrl:"",_nonce:"",logged:""},U=window.cardanoPressMessages||{connected:"",connecting:"",reconnected:"",reconnecting:"",walletSyncing:"",newAssetsPulled:"",handleSaving:"",delegating:"",paying:"",clipboardCopy:"",dataMessage:""},k=()=>{const t=localStorage.getItem("_x_connectedExtension")||"";return t===""?"":`${t}${T(t)?"(VESPR Compat)":""}`},V=t=>localStorage.setItem("_x_connectedExtension",t),D=()=>(localStorage.getItem("_x_isNotified")||"false")==="true",W=t=>localStorage.setItem("_x_isNotified",t),L=t=>new Promise(e=>{if(document.querySelector(t))return e(document.querySelector(t));const a=new MutationObserver(()=>{document.querySelector(t)&&(e(document.querySelector(t)),a.disconnect())});a.observe(document.body,{childList:!0,subtree:!0})}),R=()=>{const t=()=>Math.floor((1+Math.random())*65536).toString(16).substring(1);return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},P=t=>{window.dispatchEvent(new CustomEvent("cardanoPress:addNotice",{detail:t}))},j=t=>{window.dispatchEvent(new CustomEvent("cardanoPress:removeNotice",{detail:t}))},M=async()=>{const t=k();if(!t)throw"Not connected to a wallet";return await B.getWallet(t)},F=Object.freeze(Object.defineProperty({__proto__:null,addNotice:P,generateUuid:R,getConnectedWallet:M,removeNotice:j,waitElement:L},Symbol.toStringTag,{value:"Module"}))})();export{u as C,B as E,O as N,J as __tla,P as a,U as b,q as c,W as d,V as e,T as f,k as g,M as h,D as i,$ as j,R as k,I as l,L as m,j as r,_ as s,F as u,H as w};
