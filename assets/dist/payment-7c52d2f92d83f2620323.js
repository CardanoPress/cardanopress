"use strict";(self.webpackChunkcardanopress=self.webpackChunkcardanopress||[]).push([[899],{660:(a,e,t)=>{var s=t(384),i=t(193),n=t(171),c=t(857);window.addEventListener("alpine:init",(()=>{Alpine.data("paymentForm",(()=>({isVerified:!1,isProcessing:!1,payAmount:1,quantity:1,currentBalance:0,remainingBalance:0,transactionHash:"",showAddress:!1,paymentAddress:"",recaptchaKey:"",syncedBalance:!1,async init(){if(this.payAmount=parseFloat(this.$root.dataset.amount),this.paymentAddress=this.$root.dataset.address||"",this.recaptchaKey=this.$root.dataset.recaptcha,""===this.recaptchaKey&&""===this.paymentAddress){this.isVerified=!0;const a=await(0,i.rR)();this.paymentAddress=a.data}window.addEventListener("cardanoPress:recaptcha",(async a=>{if(this.isVerified=a.detail,this.isVerified&&!this.paymentAddress){const a=await(0,i.rR)();this.paymentAddress=a.data}}),{once:!0})},isReady(a="extension"){return!("extension"!==a&&!this.isVerified||this.isProcessing)},balanceValue(a,e=!0){const t=this[a+"Balance"];return parseFloat(t)/(e?1e6:1)},lovelaceValue(){return(0,s.adaToLovelace)(this.payAmount)},totalAmount(a=!0){const e=100*this.payAmount*(100*this.quantity)/1e4;return a?e.toFixed(1):(0,s.adaToLovelace)(e)},async syncBalance(){(0,c.addNotice)({id:"balance",type:"info",text:n.GY.walletSyncing}),this.isProcessing=!0;try{const a=await(0,c.getConnectedWallet)();this.currentBalance=parseInt(await a.getBalance()),this.remainingBalance=this.currentBalance-parseInt(this.lovelaceValue()),this.syncedBalance=!0}catch(a){(0,c.addNotice)({type:"error",text:a})}(0,c.removeNotice)("balance"),this.isProcessing=!1},async handlePayment(){if(this.transactionHash="",(0,c.addNotice)({id:"payment",type:"info",text:n.GY.paying}),!this.paymentAddress){const{success:a,data:e}=await(0,i.rR)();a&&(this.paymentAddress=e)}this.isProcessing=!0;const a=await(0,i.bo)(this.totalAmount(!1),this.paymentAddress);(0,c.removeNotice)("payment"),a.success?(this.transactionHash=a.data.hash,(0,c.addNotice)({type:"info",text:a.data.message})):(0,c.addNotice)({type:"warning",text:a.data}),this.isProcessing=!1}})))})),window.cardanoPressRecaptchaCallback=()=>{const a=a=>window.dispatchEvent(new CustomEvent("cardanoPress:recaptcha",{detail:a}));window.addEventListener("alpine:init",(()=>{(0,c.waitElement)("#cardanopress-recaptcha").then((e=>{grecaptcha.render(e,{callback:()=>{a(!0)},"expired-callback":()=>{a(!1)},"error-callback":()=>{a(!1)}})}))}))}}},a=>{a(a.s=660)}]);